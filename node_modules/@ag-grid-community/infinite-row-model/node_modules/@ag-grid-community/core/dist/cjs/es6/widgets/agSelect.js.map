{"version":3,"sources":["../../../src/ts/widgets/agSelect.ts"],"names":[],"mappings":"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","file":"agSelect.js","sourcesContent":["import { AgAbstractField } from \"./agAbstractField\";\nimport { AgPickerField } from \"./agPickerField\";\nimport { ListOption, AgList } from \"./agList\";\nimport { Autowired, PostConstruct } from \"../context/context\";\nimport { PopupService } from \"./popupService\";\nimport { setElementWidth, getAbsoluteWidth, getInnerHeight } from \"../utils/dom\";\nimport { IAgLabel } from './agAbstractLabel';\nimport { setAriaExpanded } from \"../utils/aria\";\n\nexport class AgSelect extends AgPickerField<HTMLSelectElement, string> {\n    protected listComponent: AgList;\n    private hideList: ((event?: any) => void) | null;\n\n    @Autowired('popupService') private popupService: PopupService;\n\n    constructor(config?: IAgLabel) {\n        super(config, 'ag-select', 'smallDown', 'listbox');\n    }\n\n    @PostConstruct\n    public init(): void {\n        this.listComponent = this.createBean(new AgList('select'));\n        this.listComponent.setParentComponent(this);\n        this.eWrapper.tabIndex = 0;\n\n        this.listComponent.addManagedListener(\n            this.listComponent,\n            AgList.EVENT_ITEM_SELECTED,\n            () => { if (this.hideList) { this.hideList(); } }\n        );\n\n        this.listComponent.addManagedListener(\n            this.listComponent,\n            AgAbstractField.EVENT_CHANGED,\n            () => {\n                this.setValue(this.listComponent.getValue(), false, true);\n\n                if (this.hideList) { this.hideList(); }\n            }\n        );\n    }\n\n    public showPicker() {\n        const listGui = this.listComponent.getGui();\n        const eDocument = this.gridOptionsWrapper.getDocument();\n\n        const destroyMouseWheelFunc = this.addManagedListener(eDocument.body, 'wheel', (e: MouseEvent) => {\n            if (!listGui.contains(e.target as HTMLElement) && this.hideList) {\n                this.hideList();\n            }\n        });\n\n        const destroyFocusOutFunc = this.addManagedListener(listGui, 'focusout', (e: FocusEvent) => {\n            if (!listGui.contains(e.relatedTarget as HTMLElement) && this.hideList) {\n                this.hideList();\n            }\n        });\n\n        const translate = this.gridOptionsWrapper.getLocaleTextFunc();\n\n        const addPopupRes = this.popupService.addPopup({\n            modal: true,\n            eChild: listGui,\n            closeOnEsc: true,\n            closedCallback: () => {\n                this.hideList = null;\n                this.isPickerDisplayed = false;\n                destroyFocusOutFunc!();\n                destroyMouseWheelFunc!();\n\n                if (this.isAlive()) {\n                    setAriaExpanded(this.eWrapper, false);\n                    this.getFocusableElement().focus();\n                }\n            },\n            ariaLabel: translate('ariaLabelSelectField', 'Select Field')\n        });\n\n        if (addPopupRes) {\n            this.hideList = addPopupRes.hideFunc;\n        }\n        this.isPickerDisplayed = true;\n\n        setElementWidth(listGui, getAbsoluteWidth(this.eWrapper));\n        setAriaExpanded(this.eWrapper, true);\n\n        listGui.style.maxHeight = getInnerHeight(this.popupService.getPopupParent()) + 'px';\n        listGui.style.position = 'absolute';\n\n        this.popupService.positionPopupUnderComponent({\n            type: 'ag-list',\n            eventSource: this.eWrapper,\n            ePopup: listGui,\n            keepWithinBounds: true\n        });\n\n        this.listComponent.refreshHighlighted();\n\n        return this.listComponent;\n    }\n\n    public addOptions(options: ListOption[]): this {\n        options.forEach(option => this.addOption(option));\n\n        return this;\n    }\n\n    public addOption(option: ListOption): this {\n        this.listComponent.addOption(option);\n\n        return this;\n    }\n\n    public setValue(value?: string | null, silent?: boolean, fromPicker?: boolean): this {\n        if (this.value === value) { return this; }\n\n        if (!fromPicker) {\n            this.listComponent.setValue(value, true);\n        }\n\n        const newValue = this.listComponent.getValue();\n\n        if (newValue === this.getValue()) { return this; }\n\n        this.eDisplayField.innerHTML = this.listComponent.getDisplayValue()!;\n\n        return super.setValue(value, silent);\n    }\n\n    protected destroy(): void {\n        if (this.hideList) {\n            this.hideList();\n        }\n\n        this.destroyBean(this.listComponent);\n        super.destroy();\n    }\n}\n"]}
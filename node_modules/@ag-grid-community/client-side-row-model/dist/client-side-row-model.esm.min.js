/**
          * @ag-grid-community/client-side-row-model - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v27.3.0
          * @link https://www.ag-grid.com/
          * @license MIT
          */
/**
          * @ag-grid-community/client-side-row-model - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v27.3.0
          * @link https://www.ag-grid.com/
          * @license MIT
          */
import{_ as e,Events as t,RowNode as o,ClientSideRowModelSteps as r,GridOptionsWrapper as i,Constants as n,RowHighlightPosition as s,ChangedPath as a,Autowired as d,Optional as p,PostConstruct as l,Bean as h,BeanStub as c,ModuleNames as u}from"@ag-grid-community/core";var f,g,v=function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var r,i,n=o.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=n.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(o=n.return)&&o.call(n)}finally{if(i)throw i.error}}return s},y=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e},w=function(){function r(e,t,o,i,n,s,a,d){this.nextId=0,this.allNodesMap={},this.rootNode=e,this.gridOptionsWrapper=t,this.eventService=o,this.columnModel=i,this.gridApi=n,this.columnApi=s,this.beans=d,this.selectionService=a,this.rootNode.group=!0,this.rootNode.level=-1,this.rootNode.id=r.ROOT_NODE_ID,this.rootNode.allLeafChildren=[],this.rootNode.childrenAfterGroup=[],this.rootNode.childrenAfterSort=[],this.rootNode.childrenAfterAggFilter=[],this.rootNode.childrenAfterFilter=[],this.postConstruct()}return r.prototype.postConstruct=function(){this.suppressParentsInRowNodes=this.gridOptionsWrapper.isSuppressParentsInRowNodes(),this.isRowMasterFunc=this.gridOptionsWrapper.getIsRowMasterFunc(),this.doingTreeData=this.gridOptionsWrapper.isTreeData(),this.doingMasterDetail=this.gridOptionsWrapper.isMasterDetail()},r.prototype.getCopyOfNodesMap=function(){return e.cloneObject(this.allNodesMap)},r.prototype.getRowNode=function(e){return this.allNodesMap[e]},r.prototype.setRowData=function(e){var t=this;if("string"!=typeof e){var o=this.rootNode,i=this.rootNode.sibling;o.childrenAfterFilter=null,o.childrenAfterGroup=null,o.childrenAfterAggFilter=null,o.childrenAfterSort=null,o.childrenMapped=null,o.updateHasChildren(),this.nextId=0,this.allNodesMap={},e?o.allLeafChildren=e.map((function(e){return t.createNode(e,t.rootNode,r.TOP_LEVEL)})):(o.allLeafChildren=[],o.childrenAfterGroup=[]),i&&(i.childrenAfterFilter=o.childrenAfterFilter,i.childrenAfterGroup=o.childrenAfterGroup,i.childrenAfterAggFilter=o.childrenAfterAggFilter,i.childrenAfterSort=o.childrenAfterSort,i.childrenMapped=o.childrenMapped,i.allLeafChildren=o.allLeafChildren)}else console.warn("AG Grid: rowData must be an array, however you passed in a string. If you are loading JSON, make sure you convert the JSON string to JavaScript objects first")},r.prototype.updateRowData=function(t,o){var r={remove:[],update:[],add:[]},i=[];return this.executeRemove(t,r,i),this.executeUpdate(t,r,i),this.executeAdd(t,r),this.updateSelection(i),o&&e.sortRowNodesByOrder(this.rootNode.allLeafChildren,o),r},r.prototype.updateSelection=function(e){var o=e.length>0;if(o&&e.forEach((function(e){e.setSelected(!1,!1,!0)})),this.selectionService.updateGroupsFromChildrenSelections(),o){var r={type:t.EVENT_SELECTION_CHANGED,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(r)}},r.prototype.executeAdd=function(t,o){var i=this,n=t.add,s=t.addIndex;if(!e.missingOrEmpty(n)){var a,d,p=n.map((function(e){return i.createNode(e,i.rootNode,r.TOP_LEVEL)}));if("number"==typeof s&&s>=0){var l=this.rootNode.allLeafChildren,h=0===s?0:l.reduce((function(e,t,o){var r,i=t.rowIndex,n=null===(r=l[e])||void 0===r?void 0:r.rowIndex;return null!=i&&null!=n&&i<s&&i>n?o:e}),0)+1;a=l.slice(0,h),d=l.slice(h,l.length)}else a=this.rootNode.allLeafChildren,d=[];this.rootNode.allLeafChildren=y(a,p,d),this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren),o.add=p}},r.prototype.executeRemove=function(t,o,r){var i=this,n=t.remove;if(!e.missingOrEmpty(n)){var s={};n.forEach((function(e){var t=i.lookupRowNode(e);t&&(t.isSelected()&&r.push(t),t.clearRowTopAndRowIndex(),s[t.id]=!0,delete i.allNodesMap[t.id],o.remove.push(t))})),this.rootNode.allLeafChildren=this.rootNode.allLeafChildren.filter((function(e){return!s[e.id]})),this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren)}},r.prototype.executeUpdate=function(t,o,i){var n=this,s=t.update;e.missingOrEmpty(s)||s.forEach((function(e){var t=n.lookupRowNode(e);t&&(t.updateData(e),!t.selectable&&t.isSelected()&&i.push(t),n.setMasterForRow(t,e,r.TOP_LEVEL,!1),o.update.push(t))}))},r.prototype.lookupRowNode=function(e){var t,o=this.gridOptionsWrapper.getRowIdFunc();if(o){var r=o({data:e,level:0});if(!(t=this.allNodesMap[r]))return console.error("AG Grid: could not find row id="+r+", data item was not found for this id"),null}else if(!(t=this.rootNode.allLeafChildren.find((function(t){return t.data===e}))))return console.error("AG Grid: could not find data item as object was not found",e),console.error("Consider using getRowId to help the Grid find matching row data"),null;return t||null},r.prototype.createNode=function(e,t,r){var i=new o(this.beans);return i.group=!1,this.setMasterForRow(i,e,r,!0),t&&!this.suppressParentsInRowNodes&&(i.parent=t),i.level=r,i.setDataAndId(e,this.nextId.toString()),this.allNodesMap[i.id]&&console.warn("AG Grid: duplicate node id '"+i.id+"' detected from getRowId callback, this could cause issues in your grid."),this.allNodesMap[i.id]=i,this.nextId++,i},r.prototype.setMasterForRow=function(e,t,o,r){if(this.doingTreeData)e.setMaster(!1),r&&(e.expanded=!1);else if(this.doingMasterDetail?this.isRowMasterFunc?e.setMaster(this.isRowMasterFunc(t)):e.setMaster(!0):e.setMaster(!1),r){var i=this.columnModel.getRowGroupColumns(),n=o+(i?i.length:0);e.expanded=!!e.master&&this.isExpanded(n)}},r.prototype.isExpanded=function(e){var t=this.gridOptionsWrapper.getGroupDefaultExpanded();return-1===t||e<t},r.TOP_LEVEL=0,r.ROOT_NODE_ID="ROOT_NODE_ID",r}(),A=(f=function(e,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),R=function(e,t,o,r){var i,n=arguments.length,s=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,o,s):i(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s};!function(e){e[e.Normal=0]="Normal",e[e.AfterFilter=1]="AfterFilter",e[e.AfterFilterAndSort=2]="AfterFilterAndSort",e[e.PivotNodes=3]="PivotNodes"}(g||(g={}));var N=function(c){function u(){return null!==c&&c.apply(this,arguments)||this}return A(u,c),u.prototype.init=function(){var e=this.refreshModel.bind(this,{step:r.EVERYTHING}),n=!this.gridOptionsWrapper.isSuppressAnimationFrame(),s=this.refreshModel.bind(this,{step:r.EVERYTHING,afterColumnsChanged:!0,keepRenderedRows:!0,animate:n});this.addManagedListener(this.eventService,t.EVENT_NEW_COLUMNS_LOADED,s),this.addManagedListener(this.eventService,t.EVENT_COLUMN_ROW_GROUP_CHANGED,e),this.addManagedListener(this.eventService,t.EVENT_COLUMN_VALUE_CHANGED,this.onValueChanged.bind(this)),this.addManagedListener(this.eventService,t.EVENT_COLUMN_PIVOT_CHANGED,this.refreshModel.bind(this,{step:r.PIVOT})),this.addManagedListener(this.eventService,t.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,t.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,t.EVENT_COLUMN_PIVOT_MODE_CHANGED,e);var a=this.refreshModel.bind(this,{step:r.MAP,keepRenderedRows:!0,animate:n});this.addManagedListener(this.gridOptionsWrapper,i.PROP_GROUP_REMOVE_SINGLE_CHILDREN,a),this.addManagedListener(this.gridOptionsWrapper,i.PROP_GROUP_REMOVE_LOWEST_SINGLE_CHILDREN,a),this.rootNode=new o(this.beans),this.nodeManager=new w(this.rootNode,this.gridOptionsWrapper,this.eventService,this.columnModel,this.gridApi,this.columnApi,this.selectionService,this.beans)},u.prototype.start=function(){var e=this.gridOptionsWrapper.getRowData();e&&this.setRowData(e)},u.prototype.ensureRowHeightsValid=function(e,t,o,r){var i,n=!1;do{i=!1;for(var s=this.getRowIndexAtPixel(e),a=this.getRowIndexAtPixel(t),d=Math.max(s,o),p=Math.min(a,r),l=d;l<=p;l++){var h=this.getRow(l);if(h.rowHeightEstimated){var c=this.gridOptionsWrapper.getRowHeightForNode(h);h.setRowHeight(c.height),i=!0,n=!0}}i&&this.setRowTopAndRowIndex()}while(i);return n},u.prototype.setRowTopAndRowIndex=function(){for(var e=this.gridOptionsWrapper.getDefaultRowHeight(),t=0,o=new Set,r=this.gridOptionsWrapper.getDomLayout()===n.DOM_LAYOUT_NORMAL,i=0;i<this.rowsToDisplay.length;i++){var s=this.rowsToDisplay[i];if(null!=s.id&&o.add(s.id),null==s.rowHeight){var a=this.gridOptionsWrapper.getRowHeightForNode(s,r,e);s.setRowHeight(a.height,a.estimated)}s.setRowTop(t),s.setRowIndex(i),t+=s.rowHeight}return o},u.prototype.clearRowTopAndRowIndex=function(e,t){var o=e.isActive(),r=function(e){e&&null!=e.id&&!t.has(e.id)&&e.clearRowTopAndRowIndex()},i=function(e){if(r(e),r(e.detailNode),r(e.sibling),e.hasChildren()&&e.childrenAfterGroup){var t=-1==e.level;o&&!t&&!e.expanded||e.childrenAfterGroup.forEach(i)}};i(this.rootNode)},u.prototype.ensureRowsAtPixel=function(t,o,i){var n=this;void 0===i&&(i=0);var s=this.getRowIndexAtPixel(o),a=this.getRow(s),d=!this.gridOptionsWrapper.isSuppressAnimationFrame();return a!==t[0]&&(t.forEach((function(t){e.removeFromArray(n.rootNode.allLeafChildren,t)})),t.forEach((function(t,o){e.insertIntoArray(n.rootNode.allLeafChildren,t,Math.max(s+i,0)+o)})),this.refreshModel({step:r.EVERYTHING,keepRenderedRows:!0,keepEditingRows:!0,animate:d}),!0)},u.prototype.highlightRowAtPixel=function(e,t){var o=null!=t?this.getRowIndexAtPixel(t):null,r=null!=o?this.getRow(o):null;if(r&&e&&r!==e&&null!=t){var i=this.getHighlightPosition(t,r);this.lastHighlightedRow&&this.lastHighlightedRow!==r&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null),r.setHighlighted(i),this.lastHighlightedRow=r}else this.lastHighlightedRow&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null)},u.prototype.getHighlightPosition=function(e,t){if(!t){var o=this.getRowIndexAtPixel(e);if(!(t=this.getRow(o||0)))return s.Below}return e-t.rowTop<t.rowHeight/2?s.Above:s.Below},u.prototype.getLastHighlightedRowNode=function(){return this.lastHighlightedRow},u.prototype.isLastRowIndexKnown=function(){return!0},u.prototype.getRowCount=function(){return this.rowsToDisplay?this.rowsToDisplay.length:0},u.prototype.getTopLevelRowCount=function(){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return 1;var e=this.rootNode.childrenAfterAggFilter;return e?e.length:0},u.prototype.getTopLevelRowDisplayedIndex=function(e){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return e;var t=this.rootNode.childrenAfterSort[e];if(this.gridOptionsWrapper.isGroupHideOpenParents())for(;t.expanded&&t.childrenAfterSort&&t.childrenAfterSort.length>0;)t=t.childrenAfterSort[0];return t.rowIndex},u.prototype.getRowBounds=function(t){if(e.missing(this.rowsToDisplay))return null;var o=this.rowsToDisplay[t];return o?{rowTop:o.rowTop,rowHeight:o.rowHeight}:null},u.prototype.onRowGroupOpened=function(){var e=this.gridOptionsWrapper.isAnimateRows();this.refreshModel({step:r.MAP,keepRenderedRows:!0,animate:e})},u.prototype.onFilterChanged=function(e){if(!e.afterDataChange){var t=this.gridOptionsWrapper.isAnimateRows(),o=0===e.columns.length||e.columns.some((function(e){return e.isPrimary()}))?r.FILTER:r.FILTER_AGGREGATES;this.refreshModel({step:o,keepRenderedRows:!0,animate:t})}},u.prototype.onSortChanged=function(){var e=this.gridOptionsWrapper.isAnimateRows();this.refreshModel({step:r.SORT,keepRenderedRows:!0,animate:e,keepEditingRows:!0})},u.prototype.getType=function(){return n.ROW_MODEL_TYPE_CLIENT_SIDE},u.prototype.onValueChanged=function(){this.columnModel.isPivotActive()?this.refreshModel({step:r.PIVOT}):this.refreshModel({step:r.AGGREGATE})},u.prototype.createChangePath=function(t){var o=e.missingOrEmpty(t),r=new a(!1,this.rootNode);return(o||this.gridOptionsWrapper.isTreeData())&&r.setInactive(),r},u.prototype.isSuppressModelUpdateAfterUpdateTransaction=function(e){if(!this.gridOptionsWrapper.isSuppressModelUpdateAfterUpdateTransaction())return!1;if(null==e.rowNodeTransactions)return!1;var t=e.rowNodeTransactions.filter((function(e){return null!=e.add&&e.add.length>0||null!=e.remove&&e.remove.length>0}));return null==t||0==t.length},u.prototype.refreshModel=function(e){if(!this.isSuppressModelUpdateAfterUpdateTransaction(e)){var o=this.createChangePath(e.rowNodeTransactions);switch(e.step){case r.EVERYTHING:this.doRowGrouping(e.groupState,e.rowNodeTransactions,e.rowNodeOrder,o,!!e.afterColumnsChanged);case r.FILTER:this.doFilter(o);case r.PIVOT:this.doPivot(o);case r.AGGREGATE:this.doAggregate(o);case r.FILTER_AGGREGATES:this.doFilterAggregates(o);case r.SORT:this.doSort(e.rowNodeTransactions,o);case r.MAP:this.doRowsToDisplay()}var i=this.setRowTopAndRowIndex();this.clearRowTopAndRowIndex(o,i);var n={type:t.EVENT_MODEL_UPDATED,api:this.gridApi,columnApi:this.columnApi,animate:e.animate,keepRenderedRows:e.keepRenderedRows,newData:e.newData,newPage:!1};this.eventService.dispatchEvent(n)}},u.prototype.isEmpty=function(){var t=e.missing(this.rootNode.allLeafChildren)||0===this.rootNode.allLeafChildren.length;return e.missing(this.rootNode)||t||!this.columnModel.isReady()},u.prototype.isRowsToRender=function(){return e.exists(this.rowsToDisplay)&&this.rowsToDisplay.length>0},u.prototype.getNodesInRangeForSelection=function(e,t){var o,r=!t,i=!1,n=[],s=this.gridOptionsWrapper.isGroupSelectsChildren();return this.forEachNodeAfterFilterAndSort((function(a){var d=r&&!i;if(r||a!==t&&a!==e||(r=!0),!(a.group&&s)){var p=r&&!i,l=a.isParentOfNode(o);(p||l)&&n.push(a)}d&&(a!==t&&a!==e||(i=!0,o=a===t?t:e))})),n},u.prototype.setDatasource=function(e){console.error("AG Grid: should never call setDatasource on clientSideRowController")},u.prototype.getTopLevelNodes=function(){return this.rootNode?this.rootNode.childrenAfterGroup:null},u.prototype.getRootNode=function(){return this.rootNode},u.prototype.getRow=function(e){return this.rowsToDisplay[e]},u.prototype.isRowPresent=function(e){return this.rowsToDisplay.indexOf(e)>=0},u.prototype.getRowIndexAtPixel=function(t){if(this.isEmpty())return-1;var o=0,r=this.rowsToDisplay.length-1;if(t<=0)return 0;if(e.last(this.rowsToDisplay).rowTop<=t)return this.rowsToDisplay.length-1;for(;;){var i=Math.floor((o+r)/2),n=this.rowsToDisplay[i];if(this.isRowInPixel(n,t))return i;n.rowTop<t?o=i+1:n.rowTop>t&&(r=i-1)}},u.prototype.isRowInPixel=function(e,t){var o=e.rowTop,r=e.rowTop+e.rowHeight;return o<=t&&r>t},u.prototype.forEachLeafNode=function(e){this.rootNode.allLeafChildren&&this.rootNode.allLeafChildren.forEach((function(t,o){return e(t,o)}))},u.prototype.forEachNode=function(e){this.recursivelyWalkNodesAndCallback(this.rootNode.childrenAfterGroup,e,g.Normal,0)},u.prototype.forEachNodeAfterFilter=function(e){this.recursivelyWalkNodesAndCallback(this.rootNode.childrenAfterAggFilter,e,g.AfterFilter,0)},u.prototype.forEachNodeAfterFilterAndSort=function(e){this.recursivelyWalkNodesAndCallback(this.rootNode.childrenAfterSort,e,g.AfterFilterAndSort,0)},u.prototype.forEachPivotNode=function(e){this.recursivelyWalkNodesAndCallback([this.rootNode],e,g.PivotNodes,0)},u.prototype.recursivelyWalkNodesAndCallback=function(e,t,o,r){if(!e)return r;for(var i=0;i<e.length;i++){var n=e[i];if(t(n,r++),n.hasChildren()){var s=null;switch(o){case g.Normal:s=n.childrenAfterGroup;break;case g.AfterFilter:s=n.childrenAfterAggFilter;break;case g.AfterFilterAndSort:s=n.childrenAfterSort;break;case g.PivotNodes:s=n.leafGroup?null:n.childrenAfterSort}s&&(r=this.recursivelyWalkNodesAndCallback(s,t,o,r))}}return r},u.prototype.doAggregate=function(e){this.aggregationStage&&this.aggregationStage.execute({rowNode:this.rootNode,changedPath:e})},u.prototype.doFilterAggregates=function(e){this.filterAggregatesStage?this.filterAggregatesStage.execute({rowNode:this.rootNode,changedPath:e}):this.rootNode.childrenAfterAggFilter=this.rootNode.childrenAfterFilter},u.prototype.expandOrCollapseAll=function(o){var i=this.gridOptionsWrapper.isTreeData(),n=this.columnModel.isPivotActive(),s=function(t){t&&t.forEach((function(t){var r=function(){t.expanded=o,s(t.childrenAfterGroup)};i?e.exists(t.childrenAfterGroup)&&r():n?!t.leafGroup&&r():t.group&&r()}))};this.rootNode&&s(this.rootNode.childrenAfterGroup),this.refreshModel({step:r.MAP});var a=o?"expandAll":"collapseAll",d={api:this.gridApi,columnApi:this.columnApi,type:t.EVENT_EXPAND_COLLAPSE_ALL,source:a};this.eventService.dispatchEvent(d)},u.prototype.doSort=function(e,t){this.sortStage.execute({rowNode:this.rootNode,rowNodeTransactions:e,changedPath:t})},u.prototype.doRowGrouping=function(e,t,o,r,i){this.groupStage?(t?this.groupStage.execute({rowNode:this.rootNode,rowNodeTransactions:t,rowNodeOrder:o,changedPath:r}):(this.groupStage.execute({rowNode:this.rootNode,changedPath:r,afterColumnsChanged:i}),this.restoreGroupState(e)),this.gridOptionsWrapper.isGroupSelectsChildren()&&this.selectionService.updateGroupsFromChildrenSelections(r)):(this.rootNode.childrenAfterGroup=this.rootNode.allLeafChildren,this.rootNode.sibling&&(this.rootNode.sibling.childrenAfterGroup=this.rootNode.childrenAfterGroup),this.rootNode.updateHasChildren())},u.prototype.restoreGroupState=function(t){t&&e.traverseNodesWithKey(this.rootNode.childrenAfterGroup,(function(e,o){"boolean"==typeof t[o]&&(e.expanded=t[o])}))},u.prototype.doFilter=function(e){this.filterStage.execute({rowNode:this.rootNode,changedPath:e})},u.prototype.doPivot=function(e){this.pivotStage&&this.pivotStage.execute({rowNode:this.rootNode,changedPath:e})},u.prototype.getGroupState=function(){if(!this.rootNode.childrenAfterGroup||!this.gridOptionsWrapper.isRememberGroupStateWhenNewData())return null;var t={};return e.traverseNodesWithKey(this.rootNode.childrenAfterGroup,(function(e,o){return t[o]=e.expanded})),t},u.prototype.getCopyOfNodesMap=function(){return this.nodeManager.getCopyOfNodesMap()},u.prototype.getRowNode=function(e){if("string"==typeof e&&0==e.indexOf(o.ID_PREFIX_ROW_GROUP)){var t=void 0;return this.forEachNode((function(o){o.id===e&&(t=o)})),t}return this.nodeManager.getRowNode(e)},u.prototype.setRowData=function(e){var o=this.getGroupState();this.nodeManager.setRowData(e),this.selectionService.reset(),this.filterManager.onNewRowsLoaded("rowDataUpdated");var i={type:t.EVENT_ROW_DATA_CHANGED,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(i),this.refreshModel({step:r.EVERYTHING,groupState:o,newData:!0})},u.prototype.batchUpdateRowData=function(e,t){var o=this;if(null==this.applyAsyncTransactionsTimeout){this.rowDataTransactionBatch=[];var r=this.gridOptionsWrapper.getAsyncTransactionWaitMillis();this.applyAsyncTransactionsTimeout=window.setTimeout((function(){o.executeBatchUpdateRowData()}),r)}this.rowDataTransactionBatch.push({rowDataTransaction:e,callback:t})},u.prototype.flushAsyncTransactions=function(){null!=this.applyAsyncTransactionsTimeout&&(clearTimeout(this.applyAsyncTransactionsTimeout),this.executeBatchUpdateRowData())},u.prototype.executeBatchUpdateRowData=function(){var e=this;this.valueCache.onDataChanged();var o=[],r=[],i=!1;if(this.rowDataTransactionBatch&&this.rowDataTransactionBatch.forEach((function(t){var n=e.nodeManager.updateRowData(t.rowDataTransaction,void 0);r.push(n),t.callback&&o.push(t.callback.bind(null,n)),"number"==typeof t.rowDataTransaction.addIndex&&(i=!0)})),this.commonUpdateRowData(r,void 0,i),o.length>0&&window.setTimeout((function(){o.forEach((function(e){return e()}))}),0),r.length>0){var n={api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi(),type:t.EVENT_ASYNC_TRANSACTIONS_FLUSHED,results:r};this.eventService.dispatchEvent(n)}this.rowDataTransactionBatch=null,this.applyAsyncTransactionsTimeout=void 0},u.prototype.updateRowData=function(e,t){this.valueCache.onDataChanged();var o=this.nodeManager.updateRowData(e,t),r="number"==typeof e.addIndex;return this.commonUpdateRowData([o],t,r),o},u.prototype.createRowNodeOrder=function(){if(!this.gridOptionsWrapper.isSuppressMaintainUnsortedOrder()){var e={};if(this.rootNode&&this.rootNode.allLeafChildren)for(var t=0;t<this.rootNode.allLeafChildren.length;t++){e[this.rootNode.allLeafChildren[t].id]=t}return e}},u.prototype.commonUpdateRowData=function(e,o,i){var n=!this.gridOptionsWrapper.isSuppressAnimationFrame();i&&(o=this.createRowNodeOrder()),this.refreshModel({step:r.EVERYTHING,rowNodeTransactions:e,rowNodeOrder:o,keepRenderedRows:!0,keepEditingRows:!0,animate:n});var s={type:t.EVENT_ROW_DATA_UPDATED,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(s)},u.prototype.doRowsToDisplay=function(){this.rowsToDisplay=this.flattenStage.execute({rowNode:this.rootNode})},u.prototype.onRowHeightChanged=function(){this.refreshModel({step:r.MAP,keepRenderedRows:!0,keepEditingRows:!0})},u.prototype.resetRowHeights=function(){var e=!1;this.forEachNode((function(t){t.setRowHeight(t.rowHeight,!0);var o=t.detailNode;o&&o.setRowHeight(o.rowHeight,!0),e=!0})),e&&this.onRowHeightChanged()},R([d("columnModel")],u.prototype,"columnModel",void 0),R([d("selectionService")],u.prototype,"selectionService",void 0),R([d("filterManager")],u.prototype,"filterManager",void 0),R([d("valueCache")],u.prototype,"valueCache",void 0),R([d("columnApi")],u.prototype,"columnApi",void 0),R([d("gridApi")],u.prototype,"gridApi",void 0),R([d("animationFrameService")],u.prototype,"animationFrameService",void 0),R([d("beans")],u.prototype,"beans",void 0),R([d("filterStage")],u.prototype,"filterStage",void 0),R([d("sortStage")],u.prototype,"sortStage",void 0),R([d("flattenStage")],u.prototype,"flattenStage",void 0),R([p("groupStage")],u.prototype,"groupStage",void 0),R([p("aggregationStage")],u.prototype,"aggregationStage",void 0),R([p("pivotStage")],u.prototype,"pivotStage",void 0),R([p("filterAggregatesStage")],u.prototype,"filterAggregatesStage",void 0),R([l],u.prototype,"init",null),u=R([h("rowModel")],u)}(c),O=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),m=function(e,t,o,r){var i,n=arguments.length,s=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,o,s):i(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s},S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return O(t,e),t.prototype.execute=function(e){var t=e.changedPath;this.filterService.filter(t)},m([d("filterService")],t.prototype,"filterService",void 0),t=m([h("filterStage")],t)}(c),T=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),E=function(e,t,o,r){var i,n=arguments.length,s=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,o,s):i(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s},D=function(t){function o(){return null!==t&&t.apply(this,arguments)||this}return T(o,t),o.prototype.execute=function(t){var o=this.sortController.getSortOptions(),r=e.exists(o)&&o.length>0,i=r&&e.exists(t.rowNodeTransactions)&&this.gridOptionsWrapper.isDeltaSort(),n=o.some((function(e){return!!e.column.getColDef().showRowGroup}));this.sortService.sort(o,r,i,t.rowNodeTransactions,t.changedPath,n)},E([d("sortService")],o.prototype,"sortService",void 0),E([d("sortController")],o.prototype,"sortController",void 0),E([d("columnModel")],o.prototype,"columnModel",void 0),o=E([h("sortStage")],o)}(c),M=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),_=function(e,t,o,r){var i,n=arguments.length,s=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,o,s):i(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s},G=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return M(r,t),r.prototype.execute=function(e){var t=e.rowNode,o=[],r={value:0},i=this.columnModel.isPivotMode(),n=i&&t.leafGroup,s=n?[t]:t.childrenAfterSort;return this.recursivelyAddToRowsToDisplay(s,o,r,i,0),!n&&o.length>0&&this.gridOptionsWrapper.isGroupIncludeTotalFooter()&&(this.ensureFooterNodeExists(t),this.addRowNodeToRowsToDisplay(t.sibling,o,r,0)),o},r.prototype.recursivelyAddToRowsToDisplay=function(t,o,r,i,n){if(!e.missingOrEmpty(t))for(var s=this.gridOptionsWrapper.isGroupHideOpenParents(),a=this.gridOptionsWrapper.isGroupRemoveSingleChildren(),d=!a&&this.gridOptionsWrapper.isGroupRemoveLowestSingleChildren(),p=0;p<t.length;p++){var l=t[p],h=l.hasChildren(),c=i&&!h,u=a&&h&&1===l.childrenAfterGroup.length,f=d&&h&&l.leafGroup&&1===l.childrenAfterGroup.length,g=i&&l.leafGroup,v=s&&l.expanded&&!l.master&&!g;if(!(c||v||u||f)&&this.addRowNodeToRowsToDisplay(l,o,r,n),!i||!l.leafGroup)if(h){var y=u||f;if(l.expanded||y){var w=y?n:n+1;this.recursivelyAddToRowsToDisplay(l.childrenAfterSort,o,r,i,w),this.gridOptionsWrapper.isGroupIncludeFooter()&&(this.ensureFooterNodeExists(l),this.addRowNodeToRowsToDisplay(l.sibling,o,r,n))}}else if(l.master&&l.expanded){var A=this.createDetailNode(l);this.addRowNodeToRowsToDisplay(A,o,r,n)}}},r.prototype.addRowNodeToRowsToDisplay=function(e,t,o,r){var i=this.gridOptionsWrapper.isGroupMultiAutoColumn();t.push(e),e.setUiLevel(i?0:r)},r.prototype.ensureFooterNodeExists=function(t){if(!e.exists(t.sibling)){var r=new o(this.beans);Object.keys(t).forEach((function(e){r[e]=t[e]})),r.footer=!0,r.setRowTop(null),r.setRowIndex(null),r.oldRowTop=null,e.exists(r.id)&&(r.id="rowGroupFooter_"+r.id),r.sibling=t,t.sibling=r}},r.prototype.createDetailNode=function(t){if(e.exists(t.detailNode))return t.detailNode;var r=new o(this.beans);return r.detail=!0,r.selectable=!1,r.parent=t,e.exists(t.id)&&(r.id="detail_"+t.id),r.data=t.data,r.level=t.level+1,t.detailNode=r,r},_([d("columnModel")],r.prototype,"columnModel",void 0),_([d("beans")],r.prototype,"beans",void 0),r=_([h("flattenStage")],r)}(c),C=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),P=function(e,t,o,r){var i,n=arguments.length,s=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,o,s):i(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s},b=function(t){function o(){return null!==t&&t.apply(this,arguments)||this}return C(o,t),o.prototype.init=function(){this.postSortFunc=this.gridOptionsWrapper.getPostSortFunc()},o.prototype.sort=function(e,t,o,r,i,n){var s=this,a=this.gridOptionsWrapper.isGroupMaintainOrder(),d=this.columnModel.getAllGridColumns().some((function(e){return e.isRowGroupActive()})),p={};o&&r&&(p=this.calculateDirtyNodes(r));var l=this.columnModel.isPivotMode();i&&i.forEachChangedNodeDepthFirst((function(r){s.pullDownGroupDataForHideOpenParents(r.childrenAfterAggFilter,!0);var h=l&&r.leafGroup,c=a&&d&&!r.leafGroup&&!n;if(!t||c||h){var u=r.childrenAfterAggFilter.slice(0);if(a&&r.childrenAfterSort){var f=r.childrenAfterSort.reduce((function(e,t,o){return e[t.id]=o,e}),{});u.sort((function(e,t){return(f[e.id]||0)-(f[t.id]||0)}))}r.childrenAfterSort=u}else r.childrenAfterSort=o?s.doDeltaSort(r,p,i,e):s.rowNodeSorter.doFullSort(r.childrenAfterAggFilter,e);if(r.sibling&&(r.sibling.childrenAfterSort=r.childrenAfterSort),s.updateChildIndexes(r),s.postSortFunc){var g={nodes:r.childrenAfterSort};s.postSortFunc(g)}})),this.updateGroupDataForHideOpenParents(i)},o.prototype.calculateDirtyNodes=function(e){var t={},o=function(e){e&&e.forEach((function(e){return t[e.id]=!0}))};return e&&e.forEach((function(e){o(e.add),o(e.update),o(e.remove)})),t},o.prototype.doDeltaSort=function(e,t,o,r){var i=this,n=e.childrenAfterAggFilter,s=e.childrenAfterSort;if(!s)return this.rowNodeSorter.doFullSort(n,r);var a={},d=[];n.forEach((function(e){t[e.id]||!o.canSkip(e)?d.push(e):a[e.id]=!0}));var p=s.filter((function(e){return a[e.id]})),l=function(e,t){return{currentPos:t,rowNode:e}},h=d.map(l).sort((function(e,t){return i.rowNodeSorter.compareRowNodes(r,e,t)}));return this.mergeSortedArrays(r,h,p.map(l)).map((function(e){return e.rowNode}))},o.prototype.mergeSortedArrays=function(e,t,o){for(var r=[],i=0,n=0;i<t.length&&n<o.length;){this.rowNodeSorter.compareRowNodes(e,t[i],o[n])<0?r.push(t[i++]):r.push(o[n++])}for(;i<t.length;)r.push(t[i++]);for(;n<o.length;)r.push(o[n++]);return r},o.prototype.updateChildIndexes=function(t){if(!e.missing(t.childrenAfterSort))for(var o=t.childrenAfterSort,r=0;r<o.length;r++){var i=o[r],n=0===r,s=r===t.childrenAfterSort.length-1;i.setFirstChild(n),i.setLastChild(s),i.setChildIndex(r)}},o.prototype.updateGroupDataForHideOpenParents=function(t){var o=this;if(this.gridOptionsWrapper.isGroupHideOpenParents()){if(this.gridOptionsWrapper.isTreeData()){return e.doOnce((function(){return console.warn("AG Grid: The property hideOpenParents dose not work with Tree Data. This is because Tree Data has values at the group level, it doesn't make sense to hide them (as opposed to Row Grouping, which only has Aggregated Values at the group level).")}),"sortService.hideOpenParentsWithTreeData"),!1}var r=function(e){o.pullDownGroupDataForHideOpenParents(e.childrenAfterSort,!1),e.childrenAfterSort.forEach((function(e){e.hasChildren()&&r(e)}))};t&&t.executeFromRootNode((function(e){return r(e)}))}},o.prototype.pullDownGroupDataForHideOpenParents=function(t,o){var r=this;this.gridOptionsWrapper.isGroupHideOpenParents()&&!e.missing(t)&&t.forEach((function(e){r.columnModel.getGroupDisplayColumns().forEach((function(t){var i=t.getColDef().showRowGroup;if("string"==typeof i){var n=i,s=r.columnModel.getPrimaryColumn(n);if(!(s===e.rowGroupColumn))if(o)e.setGroupValue(t.getId(),void 0);else{var a=e.getFirstChildOfFirstChild(s);a&&e.setGroupValue(t.getId(),a.key)}}else console.error("AG Grid: groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup")}))}))},P([d("columnModel")],o.prototype,"columnModel",void 0),P([d("rowNodeSorter")],o.prototype,"rowNodeSorter",void 0),P([l],o.prototype,"init",null),o=P([h("sortService")],o)}(c),F=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),x=function(e,t,o,r){var i,n=arguments.length,s=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,o,s):i(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s},I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return F(t,e),t.prototype.filter=function(e){var t=this.filterManager.isColumnFilterPresent()||this.filterManager.isQuickFilterPresent()||this.gridOptionsWrapper.isExternalFilterPresent();this.filterNodes(t,e)},t.prototype.filterNodes=function(e,t){var o=this,r=function(t,r){t.hasChildren()?t.childrenAfterFilter=e&&!r?t.childrenAfterGroup.filter((function(e){var t=e.childrenAfterFilter&&e.childrenAfterFilter.length>0,r=e.data&&o.filterManager.doesRowPassFilter({rowNode:e});return t||r})):t.childrenAfterGroup:t.childrenAfterFilter=t.childrenAfterGroup,t.sibling&&(t.sibling.childrenAfterFilter=t.childrenAfterFilter)};if(this.doingTreeDataFiltering()){var i=function(e,t){if(e.childrenAfterGroup)for(var n=0;n<e.childrenAfterGroup.length;n++){var s=e.childrenAfterGroup[n],a=t||o.filterManager.doesRowPassFilter({rowNode:s});s.childrenAfterGroup?i(e.childrenAfterGroup[n],a):r(s,a)}r(e,t)};t.executeFromRootNode((function(e){return i(e,!1)}))}else{t.forEachChangedNodeDepthFirst((function(e){return r(e,!1)}),!0)}},t.prototype.doingTreeDataFiltering=function(){return this.gridOptionsWrapper.isTreeData()&&!this.gridOptionsWrapper.isExcludeChildrenWhenTreeDataFiltering()},x([d("filterManager")],t.prototype,"filterManager",void 0),t=x([h("filterService")],t)}(c),L=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),W=function(e,t,o,r){var i,n=arguments.length,s=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,o,s):i(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s},H=function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var r,i,n=o.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=n.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(o=n.return)&&o.call(n)}finally{if(i)throw i.error}}return s},k=function(o){function r(){return null!==o&&o.apply(this,arguments)||this}return L(r,o),r.prototype.postConstruct=function(){this.rowModel.getType()===n.ROW_MODEL_TYPE_CLIENT_SIDE&&(this.clientSideRowModel=this.rowModel)},r.prototype.isActive=function(){return this.gridOptionsWrapper.isImmutableData()},r.prototype.setRowData=function(e){var o=this.createTransactionForRowData(e);if(o){var r=H(o,2),i=r[0],n=r[1],s=this.clientSideRowModel.updateRowData(i,n);s&&this.rowRenderer.refreshFullWidthRows(s.update);var a={type:t.EVENT_ROW_DATA_CHANGED,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(a)}},r.prototype.createTransactionForRowData=function(t){if(e.missing(this.clientSideRowModel))console.error("AG Grid: ImmutableService only works with ClientSideRowModel");else{var o=this.gridOptionsWrapper.getRowIdFunc();if(null!=o){var r={remove:[],update:[],add:[]},i=this.clientSideRowModel.getCopyOfNodesMap(),n=this.gridOptionsWrapper.isSuppressMaintainUnsortedOrder()?void 0:{};return e.exists(t)&&t.forEach((function(e,t){var s=o({data:e,level:0}),a=i[s];(n&&(n[s]=t),a)?(a.data!==e&&r.update.push(e),i[s]=void 0):r.add.push(e)})),e.iterateObject(i,(function(e,t){t&&r.remove.push(t.data)})),[r,n]}console.error("AG Grid: ImmutableService requires getRowId() callback to be implemented, your row data needs IDs!")}},W([d("rowModel")],r.prototype,"rowModel",void 0),W([d("rowRenderer")],r.prototype,"rowRenderer",void 0),W([d("columnApi")],r.prototype,"columnApi",void 0),W([d("gridApi")],r.prototype,"gridApi",void 0),W([l],r.prototype,"postConstruct",null),r=W([h("immutableService")],r)}(c),j={moduleName:u.ClientSideRowModelModule,beans:[S,D,G,b,I,k],rowModels:{clientSide:N}};export{j as ClientSideRowModelModule};
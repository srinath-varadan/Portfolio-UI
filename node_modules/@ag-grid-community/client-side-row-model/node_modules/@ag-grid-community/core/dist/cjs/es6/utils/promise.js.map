{"version":3,"sources":["../../../src/ts/utils/promise.ts"],"names":[],"mappings":";;;;;;;;AAEA,IAAY,eAEX;AAFD,WAAY,eAAe;IACvB,mEAAW,CAAA;IAAE,6DAAQ,CAAA;AACzB,CAAC,EAFW,eAAe,GAAf,uBAAe,KAAf,uBAAe,QAE1B;AAED,MAAa,SAAS;IA2BlB,YAAY,QAAqC;QA1BzC,WAAM,GAAoB,eAAe,CAAC,WAAW,CAAC;QACtD,eAAU,GAAa,IAAI,CAAC;QAC5B,YAAO,GAAkC,EAAE,CAAC;QAyBhD,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE,MAAM,CAAC,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC;IAC3E,CAAC;IAxBD,MAAM,CAAC,GAAG,CAAI,QAA+B;QACzC,OAAO,IAAI,SAAS,CAAC,OAAO,CAAC,EAAE;YAC3B,IAAI,kBAAkB,GAAG,QAAQ,CAAC,MAAM,CAAC;YACzC,MAAM,cAAc,GAAG,IAAI,KAAK,CAAW,kBAAkB,CAAC,CAAC;YAE/D,QAAQ,CAAC,OAAO,CAAC,CAAC,OAAO,EAAE,KAAK,EAAE,EAAE;gBAChC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE;oBACjB,cAAc,CAAC,KAAK,CAAC,GAAG,KAAK,CAAC;oBAC9B,kBAAkB,EAAE,CAAC;oBAErB,IAAI,kBAAkB,KAAK,CAAC,EAAE;wBAC1B,OAAO,CAAC,cAAc,CAAC,CAAC;qBAC3B;gBACL,CAAC,CAAC,CAAC;YACP,CAAC,CAAC,CAAC;QACP,CAAC,CAAC,CAAC;IACP,CAAC;IAED,MAAM,CAAC,OAAO,CAAI,QAAkB,IAAI;QACpC,OAAO,IAAI,SAAS,CAAI,OAAO,CAAC,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC;IACvD,CAAC;IAMM,IAAI,CAAI,IAA6B;QACxC,OAAO,IAAI,SAAS,CAAC,OAAO,CAAC,EAAE;YAC3B,IAAI,IAAI,CAAC,MAAM,KAAK,eAAe,CAAC,QAAQ,EAAE;gBAC1C,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC;aAClC;iBAAM;gBACH,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;aACpD;QACL,CAAC,CAAC,CAAC;IACP,CAAC;IAEM,UAAU,CAAI,kBAAqB,EAAE,UAAoC;QAC5E,OAAO,IAAI,CAAC,MAAM,KAAK,eAAe,CAAC,QAAQ,CAAC,CAAC,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,kBAAkB,CAAC;IACvG,CAAC;IAEO,MAAM,CAAC,KAAe;QAC1B,IAAI,CAAC,MAAM,GAAG,eAAe,CAAC,QAAQ,CAAC;QACvC,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;QAExB,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;IAClD,CAAC;IAEO,QAAQ,CAAC,MAAW;QACxB,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IACxB,CAAC;CACJ;AAvDD,8BAuDC","file":"promise.js","sourcesContent":["export type ResolveAndRejectCallback<T> = (resolve: (value: T | null) => void, reject: (params: any) => void) => void;\n\nexport enum AgPromiseStatus {\n    IN_PROGRESS, RESOLVED\n}\n\nexport class AgPromise<T> {\n    private status: AgPromiseStatus = AgPromiseStatus.IN_PROGRESS;\n    private resolution: T | null = null;\n    private waiters: ((value: T | null) => void)[] = [];\n\n    static all<T>(promises: AgPromise<T | null>[]): AgPromise<(T | null)[]> {\n        return new AgPromise(resolve => {\n            let remainingToResolve = promises.length;\n            const combinedValues = new Array<T | null>(remainingToResolve);\n\n            promises.forEach((promise, index) => {\n                promise.then(value => {\n                    combinedValues[index] = value;\n                    remainingToResolve--;\n\n                    if (remainingToResolve === 0) {\n                        resolve(combinedValues);\n                    }\n                });\n            });\n        });\n    }\n\n    static resolve<T>(value: T | null = null): AgPromise<T> {\n        return new AgPromise<T>(resolve => resolve(value));\n    }\n\n    constructor(callback: ResolveAndRejectCallback<T>) {\n        callback(value => this.onDone(value), params => this.onReject(params));\n    }\n\n    public then<V>(func: (result: T | null) => V): AgPromise<V> {\n        return new AgPromise(resolve => {\n            if (this.status === AgPromiseStatus.RESOLVED) {\n                resolve(func(this.resolution));\n            } else {\n                this.waiters.push(value => resolve(func(value)));\n            }\n        });\n    }\n\n    public resolveNow<Z>(ifNotResolvedValue: Z, ifResolved: (current: T | null) => Z): Z {\n        return this.status === AgPromiseStatus.RESOLVED ? ifResolved(this.resolution) : ifNotResolvedValue;\n    }\n\n    private onDone(value: T | null): void {\n        this.status = AgPromiseStatus.RESOLVED;\n        this.resolution = value;\n\n        this.waiters.forEach(waiter => waiter(value));\n    }\n\n    private onReject(params: any): void {\n        console.warn('TBI');\n    }\n}\n"]}
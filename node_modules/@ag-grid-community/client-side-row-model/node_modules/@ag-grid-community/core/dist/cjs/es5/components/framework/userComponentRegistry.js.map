{"version":3,"sources":["../../../src/ts/components/framework/userComponentRegistry.ts"],"names":[],"mappings":"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","file":"userComponentRegistry.js","sourcesContent":["import { BeanStub } from \"../../context/beanStub\";\nimport { Autowired, Bean, PostConstruct } from \"../../context/context\";\nimport { GridOptions } from \"../../entities/gridOptions\";\nimport { ReadOnlyFloatingFilter } from \"../../filter/floating/provided/readOnlyFloatingFilter\";\nimport { DateFilter } from \"../../filter/provided/date/dateFilter\";\nimport { DateFloatingFilter } from \"../../filter/provided/date/dateFloatingFilter\";\nimport { DefaultDateComponent } from \"../../filter/provided/date/defaultDateComponent\";\nimport { NumberFilter } from \"../../filter/provided/number/numberFilter\";\nimport { NumberFloatingFilter } from \"../../filter/provided/number/numberFloatingFilter\";\nimport { TextFilter } from \"../../filter/provided/text/textFilter\";\nimport { TextFloatingFilter } from \"../../filter/provided/text/textFloatingFilter\";\nimport { HeaderComp } from \"../../headerRendering/cells/column/headerComp\";\nimport { HeaderGroupComp } from \"../../headerRendering/cells/columnGroup/headerGroupComp\";\nimport { IComponent } from \"../../interfaces/iComponent\";\nimport { LargeTextCellEditor } from \"../../rendering/cellEditors/largeTextCellEditor\";\nimport { PopupSelectCellEditor } from \"../../rendering/cellEditors/popupSelectCellEditor\";\nimport { PopupTextCellEditor } from \"../../rendering/cellEditors/popupTextCellEditor\";\nimport { SelectCellEditor } from \"../../rendering/cellEditors/selectCellEditor\";\nimport { TextCellEditor } from \"../../rendering/cellEditors/textCellEditor\";\nimport { AnimateShowChangeCellRenderer } from \"../../rendering/cellRenderers/animateShowChangeCellRenderer\";\nimport { AnimateSlideCellRenderer } from \"../../rendering/cellRenderers/animateSlideCellRenderer\";\nimport { GroupCellRenderer } from \"../../rendering/cellRenderers/groupCellRenderer\";\nimport { LoadingCellRenderer } from \"../../rendering/cellRenderers/loadingCellRenderer\";\nimport { LoadingOverlayComponent } from \"../../rendering/overlays/loadingOverlayComponent\";\nimport { NoRowsOverlayComponent } from \"../../rendering/overlays/noRowsOverlayComponent\";\nimport { TooltipComponent } from \"../../rendering/tooltipComponent\";\nimport { doOnce } from \"../../utils/function\";\nimport { iterateObject } from '../../utils/object';\nimport { AgComponentUtils } from \"./agComponentUtils\";\n\n/**\n * B the business interface (ie IHeader)\n * A the agGridComponent interface (ie IHeaderComp). The final object acceptable by ag-grid\n */\nexport interface RegisteredComponent {\n    component: any;\n    componentFromFramework: boolean;\n}\n\nexport interface DeprecatedComponentName {\n    propertyHolder: string;\n    newComponentName: string;\n}\n\n@Bean('userComponentRegistry')\nexport class UserComponentRegistry extends BeanStub {\n\n    @Autowired('gridOptions') private gridOptions: GridOptions;\n    @Autowired('agComponentUtils') private readonly agComponentUtils: AgComponentUtils;\n\n    private agGridDefaults: { [key: string]: any } = {\n        //date\n        agDateInput: DefaultDateComponent,\n\n        //header\n        agColumnHeader: HeaderComp,\n        agColumnGroupHeader: HeaderGroupComp,\n\n        //floating filters\n        agTextColumnFloatingFilter: TextFloatingFilter,\n        agNumberColumnFloatingFilter: NumberFloatingFilter,\n        agDateColumnFloatingFilter: DateFloatingFilter,\n        agReadOnlyFloatingFilter: ReadOnlyFloatingFilter,\n\n        // renderers\n        agAnimateShowChangeCellRenderer: AnimateShowChangeCellRenderer,\n        agAnimateSlideCellRenderer: AnimateSlideCellRenderer,\n        agGroupCellRenderer: GroupCellRenderer,\n        agGroupRowRenderer: GroupCellRenderer,\n        agLoadingCellRenderer: LoadingCellRenderer,\n\n        //editors\n        agCellEditor: TextCellEditor,\n        agTextCellEditor: TextCellEditor,\n        agSelectCellEditor: SelectCellEditor,\n        agPopupTextCellEditor: PopupTextCellEditor,\n        agPopupSelectCellEditor: PopupSelectCellEditor,\n        agLargeTextCellEditor: LargeTextCellEditor,\n\n        //filter\n        agTextColumnFilter: TextFilter,\n        agNumberColumnFilter: NumberFilter,\n        agDateColumnFilter: DateFilter,\n\n        //overlays\n        agLoadingOverlay: LoadingOverlayComponent,\n        agNoRowsOverlay: NoRowsOverlayComponent,\n\n        // tooltips\n        agTooltipComponent: TooltipComponent\n    };\n\n    private agDeprecatedNames: { [key: string]: DeprecatedComponentName; } = {\n        set: {\n            newComponentName: 'agSetColumnFilter',\n            propertyHolder: 'filter'\n        },\n        text: {\n            newComponentName: 'agTextColumnFilter',\n            propertyHolder: 'filter'\n        },\n        number: {\n            newComponentName: 'agNumberColumnFilter',\n            propertyHolder: 'filter'\n        },\n        date: {\n            newComponentName: 'agDateColumnFilter',\n            propertyHolder: 'filter'\n        },\n\n        group: {\n            newComponentName: 'agGroupCellRenderer',\n            propertyHolder: 'cellRenderer'\n        },\n        animateShowChange: {\n            newComponentName: 'agAnimateShowChangeCellRenderer',\n            propertyHolder: 'cellRenderer'\n        },\n        animateSlide: {\n            newComponentName: 'agAnimateSlideCellRenderer',\n            propertyHolder: 'cellRenderer'\n        },\n\n        select: {\n            newComponentName: 'agSelectCellEditor',\n            propertyHolder: 'cellEditor'\n        },\n        largeText: {\n            newComponentName: 'agLargeTextCellEditor',\n            propertyHolder: 'cellEditor'\n        },\n        popupSelect: {\n            newComponentName: 'agPopupSelectCellEditor',\n            propertyHolder: 'cellEditor'\n        },\n        popupText: {\n            newComponentName: 'agPopupTextCellEditor',\n            propertyHolder: 'cellEditor'\n        },\n        richSelect: {\n            newComponentName: 'agRichSelectCellEditor',\n            propertyHolder: 'cellEditor'\n        },\n        headerComponent: {\n            newComponentName: 'agColumnHeader',\n            propertyHolder: 'headerComponent'\n        }\n    };\n\n    private jsComps: { [key: string]: any } = {};\n    private fwComps: { [key: string]: any } = {};\n\n    @PostConstruct\n    private init(): void {\n        if (this.gridOptions.components != null) {\n            iterateObject(this.gridOptions.components, (key, component) => this.registerJsComponent(key, component));\n        }\n\n        if (this.gridOptions.frameworkComponents != null) {\n            iterateObject(this.gridOptions.frameworkComponents,\n                (key, component) => this.registerFwComponent(key, component as any));\n        }\n    }\n\n    public registerDefaultComponent(rawName: string, component: any) {\n        const name = this.translateIfDeprecated(rawName);\n\n        if (this.agGridDefaults[name]) {\n            console.error(`Trying to overwrite a default component. You should call registerComponent`);\n            return;\n        }\n\n        this.agGridDefaults[name] = component;\n    }\n\n    private registerJsComponent(rawName: string, component: any) {\n        const name = this.translateIfDeprecated(rawName);\n\n        if (this.fwComps[name]) {\n            console.error(`Trying to register a component that you have already registered for frameworks: ${name}`);\n            return;\n        }\n\n        this.jsComps[name] = component;\n    }\n\n    /**\n     * B the business interface (ie IHeader)\n     * A the agGridComponent interface (ie IHeaderComp). The final object acceptable by ag-grid\n     */\n    private registerFwComponent<A extends IComponent<any> & B, B>(rawName: string, component: { new(): IComponent<B>; }) {\n        const warningMessage = `AG Grid: As of v27, registering components via grid property frameworkComponents is deprecated. Instead register both JavaScript AND Framework Components via the components property.`;\n        doOnce( ()=> console.warn(warningMessage), `UserComponentRegistry.frameworkComponentsDeprecated`);\n\n        const name = this.translateIfDeprecated(rawName);\n        this.fwComps[name] = component;\n    }\n\n    public retrieve(rawName: string): {componentFromFramework: boolean, component: any} | null {\n        const name = this.translateIfDeprecated(rawName);\n\n        const createResult = (component: any, componentFromFramework: boolean) => ({componentFromFramework, component});\n\n        // FrameworkOverrides.frameworkComponent() is used in two locations:\n        // 1) for Vue, user provided components get registered via a framework specific way.\n        // 2) for React, it's how the React UI provides alternative default components (eg GroupCellRenderer and DetailCellRenderer)\n        const registeredViaFrameworkComp = this.getFrameworkOverrides().frameworkComponent(name);\n        if (registeredViaFrameworkComp!=null) {\n            return createResult(registeredViaFrameworkComp, true);\n        }\n\n        const frameworkComponent = this.fwComps[name];\n        if (frameworkComponent) {\n            return createResult(frameworkComponent, true);\n        }\n\n        const jsComponent = this.jsComps[name];\n        if (jsComponent) {\n            const isFwkComp = this.getFrameworkOverrides().isFrameworkComponent(jsComponent);\n            return createResult(jsComponent, isFwkComp);\n        }\n\n        const defaultComponent = this.agGridDefaults[name];\n        if (defaultComponent) {\n            return createResult(defaultComponent, false);\n        }\n\n        if (Object.keys(this.agGridDefaults).indexOf(name) < 0) {\n            console.warn(`AG Grid: Looking for component [${name}] but it wasn't found.`);\n        }\n\n        return null;\n    }\n\n    private translateIfDeprecated(raw: string): string {\n        const deprecatedInfo = this.agDeprecatedNames[raw];\n\n        if (deprecatedInfo != null) {\n            doOnce(() => {\n                console.warn(`ag-grid. Since v15.0 component names have been renamed to be namespaced. You should rename ${deprecatedInfo.propertyHolder}:${raw} to ${deprecatedInfo.propertyHolder}:${deprecatedInfo.newComponentName}`);\n            }, 'DEPRECATE_COMPONENT_' + raw);\n\n            return deprecatedInfo.newComponentName;\n        }\n\n        return raw;\n    }\n}\n"]}
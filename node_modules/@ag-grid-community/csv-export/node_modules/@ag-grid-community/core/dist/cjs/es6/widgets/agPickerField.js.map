{"version":3,"sources":["../../../src/ts/widgets/agPickerField.ts"],"names":[],"mappings":"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","file":"agPickerField.js","sourcesContent":["import { AgAbstractField } from \"./agAbstractField\";\nimport { Component } from \"./component\";\nimport { RefSelector } from \"./componentAnnotations\";\nimport { setAriaLabelledBy, setAriaLabel, setAriaDescribedBy } from \"../utils/aria\";\nimport { createIconNoSpan } from \"../utils/icon\";\nimport { exists } from \"../utils/generic\";\nimport { setElementWidth, isVisible } from \"../utils/dom\";\nimport { KeyCode } from '../constants/keyCode';\nimport { IAgLabel } from './agAbstractLabel';\n\nexport abstract class AgPickerField<TElement extends HTMLElement, TValue> extends AgAbstractField<TValue> {\n    public abstract showPicker(): Component;\n    protected value: TValue;\n    protected isPickerDisplayed: boolean = false;\n    protected isDestroyingPicker: boolean = false;\n    private skipClick: boolean = false;\n    private pickerComponent: Component;\n\n    @RefSelector('eLabel') protected readonly eLabel: HTMLElement;\n    @RefSelector('eWrapper') protected readonly eWrapper: HTMLElement;\n    @RefSelector('eDisplayField') protected readonly eDisplayField: TElement;\n    @RefSelector('eIcon') private readonly eIcon: HTMLButtonElement;\n\n    constructor(config?: IAgLabel, className?: string, private readonly pickerIcon?: string, ariaRole?: string) {\n        super(config,\n            /* html */ `<div class=\"ag-picker-field\" role=\"presentation\">\n                <div ref=\"eLabel\"></div>\n                <div ref=\"eWrapper\"\n                    class=\"ag-wrapper ag-picker-field-wrapper\"\n                    tabIndex=\"-1\"\n                    aria-expanded=\"false\"\n                    ${ariaRole ? `role=\"${ariaRole}\"` : ''}\n                >\n                    <div ref=\"eDisplayField\" class=\"ag-picker-field-display\"></div>\n                    <div ref=\"eIcon\" class=\"ag-picker-field-icon\" aria-hidden=\"true\"></div>\n                </div>\n            </div>`, className);\n    }\n\n    protected postConstruct() {\n        super.postConstruct();\n\n        const displayId = `${this.getCompId()}-display`;\n\n        this.eDisplayField.setAttribute('id', displayId);\n        setAriaDescribedBy(this.eWrapper, displayId);\n\n        const clickHandler = () => {\n            if (this.skipClick) {\n                this.skipClick = false;\n                return;\n            }\n\n            if (this.isDisabled()) { return; }\n\n            this.pickerComponent = this.showPicker();\n        };\n\n        const eGui = this.getGui();\n\n        this.addManagedListener(eGui, 'mousedown', (e: MouseEvent) => {\n            if (\n                !this.skipClick &&\n                this.pickerComponent &&\n                this.pickerComponent.isAlive() &&\n                isVisible(this.pickerComponent.getGui()) &&\n                eGui.contains(e.target as HTMLElement)\n            ) {\n                this.skipClick = true;\n            }\n        });\n\n        this.addManagedListener(eGui, 'keydown', (e: KeyboardEvent) => {\n            switch (e.key) {\n                case KeyCode.UP:\n                case KeyCode.DOWN:\n                case KeyCode.ENTER:\n                case KeyCode.SPACE:\n                    clickHandler();\n                case KeyCode.ESCAPE:\n                    if (this.isPickerDisplayed) {\n                        e.preventDefault();\n                    }\n                    break;\n            }\n        });\n\n        this.addManagedListener(this.eWrapper, 'click', clickHandler);\n        this.addManagedListener(this.eLabel, 'click', clickHandler);\n\n        if (this.pickerIcon) {\n            const icon = createIconNoSpan(this.pickerIcon, this.gridOptionsWrapper);\n            if (icon) {\n                this.eIcon.appendChild(icon);\n            }\n        }\n    }\n\n    protected refreshLabel() {\n        if (exists(this.getLabel())) {\n            setAriaLabelledBy(this.eWrapper, this.getLabelId());\n        } else {\n            this.eWrapper.removeAttribute('aria-labelledby');\n        }\n\n        super.refreshLabel();\n    }\n\n    public setAriaLabel(label: string): this {\n        setAriaLabel(this.eWrapper, label);\n\n        return this;\n    }\n\n    public setInputWidth(width: number | 'flex'): this {\n        setElementWidth(this.eWrapper, width);\n        return this;\n    }\n\n    public getFocusableElement(): HTMLElement {\n        return this.eWrapper;\n    }\n}\n"]}